# Staging: HTTP only (host: 8082 → container: 80)
server {
  listen 80;
  server_name _;                 # 특정 도메인 고정하지 않음(8082 포트 접근 허용)

  root /var/www/html;
  index index.html;

  # 프록시: 스테이징 백엔드 컨테이너로
  location /api/ {
    proxy_pass http://Housing-app-stg:8080;  # ← 컨테이너 이름 -stg
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }

  location /uploads/ {
    proxy_pass http://Housing-app-stg:8080;
  }

  location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
    try_files $uri =404;
  }

  location / {
    try_files $uri /index.html;
  }
}
